export type Lang = "it" | "fr" | "en";

export const LANG_STORAGE_KEY = "cookops:lang";

type TranslationVars = Record<string, string | number>;

const messages: Record<Lang, Record<string, string>> = {
  it: {
    "lang.it": "Italiano",
    "lang.fr": "Francese",
    "lang.en": "Inglese",
    "app.brandSub": "CookOps - Operativita quotidiana ristorante",
    "app.selectSite": "Seleziona punto vendita",
    "app.settings": "Parametri",
    "app.menuToggle": "Apri o chiudi menu",
    "app.sidebarTitle": "Menu operativo",
    "app.sidebarToggle": "Comprimi o espandi menu laterale",
    "app.pageHead": "Punto vendita: {site} | API: {api}",
    "app.siteNotSelected": "non selezionato",
    "nav.dashboard": "Dashboard",
    "nav.dashboardHelp": "KPI e urgenze",
    "nav.inventory": "Inventario",
    "nav.inventoryHelp": "Giacenze, lotti, alert",
    "nav.purchases": "Acquisti",
    "nav.purchasesHelp": "Bolle, fatture, ingest",
    "nav.suppliers": "Fornitori e listini",
    "nav.suppliersHelp": "Anagrafica fornitori",
    "nav.recipes": "Ricette e carte",
    "nav.recipesHelp": "Carta fissa e menu giorno",
    "nav.orders": "Comande",
    "nav.ordersHelp": "Liste ingredienti e ordini",
    "nav.reconciliations": "Riconciliazioni",
    "nav.reconciliationsHelp": "Bolle e fatture",
    "nav.reports": "Report",
    "nav.reportsHelp": "Vendite POS e scostamenti",
    "notice.ready": "Pronto.",
    "notice.errorWithDetail": "{label}: {detail}",
    "notice.spaceCreated": "Spazio creato: {label}",
    "notice.sitesLoaded": "Punti vendita caricati: {count}",
    "notice.documentsLoaded": "Documenti caricati: {count}",
    "notice.suppliersUpdated": "Fornitori aggiornati: {count}",
    "notice.supplierCreated": "Fornitore creato: {name}",
    "notice.siteCreated": "Punto vendita creato: {name}",
    "notice.siteReactivated": "Punto vendita riattivato: {name}",
    "notice.siteDeleted": "Punto vendita eliminato definitivamente: {name}",
    "notice.siteDisabled": "Punto vendita disattivato.",
    "notice.documentUploaded": "Documento caricato: {name}",
    "notice.extractionSaved": "Estrazione salvata: {id}",
    "notice.documentIngested": "Documento registrato a sistema: {id}",
    "notice.reconciliationCreated": "Riconciliazione creata: {id}",
    "notice.salesImported": "Vendite importate: {id}",
    "notice.menuSaved": "Carta salvata.",
    "notice.checklistUpdated": "Checklist ingredienti aggiornata.",
    "notice.fichesSynced": "Fiches aggiornate. Letti: {read}, nuovi snapshot: {created}, invariati: {unchanged}.",
    "notice.fichesJsonImported": "Import JSON fiches completato. Letti: {read}, nuovi snapshot: {created}, invariati: {unchanged}.",
    "notice.entryUpdated": "Elemento aggiornato.",
    "notice.entryAdded": "Elemento aggiunto.",
    "action.close": "Chiudi",
    "action.edit": "Modifica",
    "action.add": "Aggiungi",
    "action.save": "Salva",
    "action.print": "Stampa",
    "action.pdf": "PDF",
    "action.generateChecklist": "Genera checklist",
    "action.loading": "Caricamento...",
    "label.language": "Lingua",
    "label.typeMenu": "Tipo carta: {type}",
    "label.noSection": "Senza sezione",
    "label.noCategory": "Senza categoria",
    "label.noSupplier": "Senza fornitore",
    "action.delete": "Elimina",
    "action.remove": "Rimuovi",
    "action.replace": "Sostituisci",
    "action.select": "Seleziona",
    "action.up": "Su",
    "action.down": "Giu",
    "confirm.disableSite": "Disattivare questo punto vendita? Potrai riattivarlo in seguito.",
    "dashboard.activeSites": "Punti vendita attivi",
    "dashboard.importedDocs": "Documenti importati",
    "dashboard.activeMenuItems": "Voci carta attive",
    "dashboard.urgencies": "Urgenze",
    "dashboard.urgency.docs": "Controlla documenti in attesa ingest",
    "dashboard.urgency.lots": "Verifica lotti con DLC ravvicinata",
    "dashboard.urgency.pos": "Conferma import POS giornaliero",
    "dashboard.foodCost": "Food cost",
    "dashboard.foodCostDesc": "Confronto teorico vs consuntivo disponibile nel modulo Report.",
    "dashboard.recoStatus": "Stato riconciliazioni",
    "dashboard.recoStatusDesc": "Usa la sezione Riconciliazioni per abbinare bolle e fatture.",
    "recipes.menuSpaces": "Spazi carta",
    "recipes.serviceDate": "Data servizio",
    "recipes.targetPortions": "Porzioni target",
    "recipes.noItems": "Nessun elemento. Premi Modifica per aggiungere piatti, cocktail o prodotti.",
    "recipes.noActiveSpace": "Nessuno spazio attivo. Attivalo nei Parametri avanzati.",
    "orders.title": "Liste comande",
    "orders.desc": "Intervallo date, filtro carte/categorie e output per fornitore, ricetta o settore.",
    "orders.dateFrom": "Data inizio",
    "orders.dateTo": "Data fine",
    "orders.includedMenus": "Carte incluse",
    "orders.include": "Includi",
    "orders.menu": "Carta",
    "orders.key": "Chiave",
    "orders.categoriesSectors": "Categorie/settori",
    "orders.sectorCategory": "Settore/Categoria",
    "orders.noCategory": "Nessuna categoria disponibile.",
    "orders.viewSupplier": "1 - Checklist per fornitore",
    "orders.viewSector": "2 - Checklist per settore",
    "orders.viewRecipe": "3 - Checklist per ricetta",
    "orders.qtySuggested": "Quantita suggerite",
    "orders.ingredientsOnly": "Solo lista ingredienti",
    "orders.searchSupplier": "Ricerca fornitore",
    "orders.searchSupplierPlaceholder": "Cerca fornitore, ingrediente o codice",
    "orders.searchSector": "Ricerca settore",
    "orders.searchSectorPlaceholder": "Cerca settore, ingrediente o fornitore",
    "orders.searchRecipe": "Ricerca ricetta",
    "orders.searchRecipePlaceholder": "Cerca ricetta o categoria",
    "orders.noResultsYet": "Nessun risultato ancora. Premi \"Genera checklist\".",
    "orders.noSupplierCard": "Nessun riquadro fornitore trovato con questa ricerca.",
    "orders.noSectorCard": "Nessun riquadro settore trovato con questa ricerca.",
    "orders.noRecipeCard": "Nessun riquadro ricetta trovato con questa ricerca.",
    "orders.derivedFromInternalPrep": "Derivato da preparazione interna",
    "orders.internalPrep": "preparazione interna",
    "orders.supplierOrderCard": "Comanda fornitore",
    "orders.sectorOrderCard": "Comanda settore",
    "orders.recipeChecklist": "Checklist ricetta",
    "suppliers.manage": "Gestione fornitori",
    "suppliers.newSupplier": "Nuovo fornitore",
    "suppliers.namePlaceholder": "Nome fornitore",
    "suppliers.addSupplier": "Aggiungi fornitore",
    "suppliers.refreshList": "Aggiorna elenco",
    "suppliers.fichesSyncDesc": "Sincronizza automaticamente tutte le fiches in CookOps (delta per hash + storico).",
    "suppliers.fichesSync": "Aggiorna fiches",
    "suppliers.fichesSyncLoading": "Aggiornamento fiches...",
    "suppliers.fichesImportDesc": "Fallback manuale: importa export JSON v1.1 da file.",
    "suppliers.fichesImport": "Importa JSON fiches v1.1",
    "suppliers.fichesImportLoading": "Import JSON fiches...",
    "suppliers.list": "Elenco fornitori",
    "suppliers.vat": "P.IVA",
    "purchases.step1Title": "1) Carica bolla o fattura",
    "purchases.documentType": "Tipo documento",
    "purchases.deliveryNote": "Bolla di consegna",
    "purchases.invoice": "Fattura",
    "purchases.file": "File",
    "purchases.uploadDocument": "Carica documento",
    "purchases.refreshDocuments": "Aggiorna documenti",
    "purchases.step2Title": "2) Controlla estrazione OCR",
    "purchases.document": "Documento",
    "purchases.readDataJson": "Dati letti (JSON)",
    "purchases.confirmOcrData": "Conferma dati OCR",
    "purchases.step3Title": "3) Registra in CookOps",
    "purchases.extractionId": "ID estrazione",
    "purchases.destination": "Destinazione",
    "purchases.deliveryNotesPlural": "Bolle",
    "purchases.invoicesPlural": "Fatture",
    "purchases.registerDocument": "Registra documento",
    "reco.manualTitle": "Riconciliazione manuale bolle/fatture",
    "reco.invoiceLine": "Riga fattura (UUID)",
    "reco.goodsReceiptLine": "Riga bolla (UUID)",
    "reco.linkInvoiceAndNote": "Collega fattura e bolla",
    "reco.status": "Stato",
    "reco.nextStep": "Step successivo: matching assistito con suggerimenti automatici e semafori.",
    "inventory.stockLots": "Giacenze e lotti",
    "inventory.item1": "Giacenze per punto vendita e settore",
    "inventory.item2": "Scadenze DLC",
    "inventory.item3": "Rettifiche manuali tracciate",
    "inventory.alerts": "Allerte",
    "inventory.alertsDesc": "In arrivo: sottoscorta, DLC ravvicinate e lotti bloccati.",
    "report.dailyPosImport": "Import giornaliero POS",
    "report.salesDate": "Data vendite",
    "report.posSourceId": "ID sorgente POS",
    "report.posSourcePlaceholder": "UUID sorgente POS",
    "report.salesLinesJson": "Righe vendite (JSON)",
    "report.importSales": "Importa vendite",
    "report.analysis": "Analisi",
    "report.analysisDesc": "In arrivo: food cost teorico vs consuntivo, scostamenti e export CSV/PDF.",
    "settings.title": "Parametri",
    "settings.apiKey": "Chiave API (X-API-Key)",
    "settings.refreshSites": "Aggiorna punti vendita",
    "settings.newSite": "Nuovo punto vendita",
    "settings.name": "Nome",
    "settings.code": "Codice",
    "settings.siteNamePlaceholder": "Es. Paillotte Beach",
    "settings.siteCodePlaceholder": "Opzionale (auto dal nome)",
    "settings.createSite": "Crea punto vendita",
    "settings.availableSites": "Punti vendita disponibili",
    "settings.active": "attivo",
    "settings.disabled": "disattivato",
    "settings.disable": "Disattiva",
    "settings.reactivate": "Riattiva",
    "settings.recipesPageSettings": "Parametri pagina Ricette e carte",
    "settings.advancedMenuSpaces": "Modalita avanzata spazi carta",
    "settings.spaces": "Spazi",
    "settings.spaceTypeRecipes": "Ricette",
    "settings.spaceTypeSupplierProducts": "Prodotti fornitore",
    "settings.spaceTypeMixed": "Misto",
    "settings.schedulePermanent": "Permanente",
    "settings.scheduleDate": "Per data",
    "settings.scheduleRecurring": "Ricorrente sett.",
    "settings.activeShort": "Attivo",
    "settings.newSpace": "Nuovo spazio",
    "settings.newSpacePlaceholder": "Es. Carta vini",
    "settings.spaceType": "Tipo spazio",
    "settings.addSpace": "Aggiungi spazio",
    "settings.sectionsForSpace": "Sezioni per spazio",
    "settings.space": "Spazio",
    "settings.newSection": "Nuova sezione",
    "settings.newSectionPlaceholder": "Es. Antipasti",
    "settings.addSection": "Aggiungi sezione",
    "menuEditor.editSpace": "Modifica spazio: {space}",
    "menuEditor.title": "Titolo",
    "menuEditor.titlePlaceholder": "Cerca ricetta/prodotto",
    "menuEditor.entryType": "Tipo voce",
    "menuEditor.entryTypeRecipe": "Ricetta",
    "menuEditor.entryTypeProduct": "Prodotto",
    "menuEditor.linkedRecipe": "Ricetta collegata",
    "menuEditor.notMapped": "non mappata (titolo non trovato)",
    "menuEditor.fichePortions": "Porzioni fiche",
    "menuEditor.targetPortions": "Porzioni target",
    "menuEditor.section": "Sezione",
    "menuEditor.schedule": "Pianificazione",
    "menuEditor.schedulePermanent": "Permanente (sempre attiva)",
    "menuEditor.scheduleDateRange": "Data specifica/intervallo",
    "menuEditor.scheduleWeekly": "Ricorrenza settimanale",
    "menuEditor.weekdays": "Giorni ricorrenti",
    "menuEditor.validFrom": "Valida dal",
    "menuEditor.validTo": "Valida al",
    "menuEditor.saveReplacement": "Salva sostituzione",
    "menuEditor.addEntry": "Aggiungi voce",
    "deleteSite.title": "Elimina punto vendita",
    "deleteSite.descStart": "Questa azione elimina definitivamente",
    "deleteSite.confirmPrompt": "Per confermare digita:",
    "deleteSite.confirmText": "ELIMINA DEFINITIVAMENTE",
    "deleteSite.deleteForever": "Elimina definitivamente",
    "table.ingredient": "Ingrediente",
    "table.supplier": "Fornitore",
    "table.supplierCode": "Codice fornitore",
    "table.qty": "Qta",
    "table.unit": "UM",
    "table.remaining": "Rimanenza",
    "table.toOrder": "Da ordinare",
    "validation.spaceNameRequired": "Inserisci il nome del nuovo spazio.",
    "validation.spaceNameInvalid": "Nome spazio non valido.",
    "validation.spaceExists": "Esiste gia uno spazio con questo nome.",
    "validation.keepAtLeastOneSpace": "Deve restare almeno uno spazio.",
    "validation.sectionExists": "Questa sezione esiste gia.",
    "validation.siteNameRequired": "Inserisci il nome del punto vendita.",
    "validation.siteCodeInvalid": "Codice punto vendita non valido.",
    "validation.selectJsonFileFirst": "Seleziona prima un file JSON export v1.1.",
    "validation.invalidJsonFile": "File JSON non valido.",
    "validation.invalidExtractionJson": "JSON estrazione non valido.",
    "validation.invalidSalesJson": "JSON righe vendita non valido.",
    "validation.entryTitleRequired": "Inserisci almeno il titolo.",
    "validation.targetPortionsGtZero": "Le porzioni target devono essere maggiori di 0.",
    "validation.weeklyNeedsDay": "Se selezioni ricorrenza settimanale, indica almeno un giorno.",
    "validation.selectSiteBeforeChecklist": "Seleziona un punto vendita prima di generare la checklist.",
    "validation.selectSite": "Seleziona un punto vendita.",
    "validation.selectValidDateRange": "Seleziona un intervallo date valido.",
    "validation.invalidDateRange": "Intervallo date non valido.",
    "validation.dateRangeTooWide": "Intervallo troppo esteso. Usa massimo 62 giorni.",
    "notice.noActiveSites": "Nessun punto vendita attivo trovato. Apri Parametri per crearne uno.",
    "error.menuLoad": "Caricamento carta KO",
    "error.menuLoadBackend": "Errore caricamento carta da backend.",
    "error.sitesLoad": "Errore punti vendita",
    "error.apiConnectionSites": "Connessione API fallita su /sites. Controlla runserver, CORS e X-API-Key.",
    "error.siteCreate": "Creazione punto vendita KO",
    "error.siteCreateConnection": "Creazione punto vendita fallita per errore di connessione/API.",
    "error.siteDisable": "Disattivazione KO",
    "error.siteDelete": "Eliminazione KO",
    "error.siteReactivate": "Riattivazione KO",
    "error.suppliersLoad": "Errore fornitori",
    "error.supplierCreate": "Creazione fornitore KO",
    "error.fichesSync": "Aggiorna fiches KO",
    "error.fichesSyncConnection": "Errore di connessione durante aggiornamento fiches.",
    "error.fichesImportJson": "Import JSON fiches KO",
    "error.fichesImportJsonConnection": "Errore di connessione durante import JSON fiches.",
    "error.documentsLoad": "Errore caricamento documenti",
    "error.documentUpload": "Upload KO",
    "error.extractionCreate": "Estrazione KO",
    "error.ingest": "Ingest KO",
    "error.reconciliationCreate": "Riconciliazione KO",
    "error.posImport": "Import POS KO",
    "error.menuSync": "Sync carta KO",
    "error.checklistForDay": "Checklist KO",
    "error.checklistConnection": "Errore di connessione durante il caricamento checklist.",
    "error.menuReloadBeforeChecklist": "Impossibile ricaricare la carta dal backend prima della checklist.",
    "error.printOpen": "Impossibile aprire il documento di stampa.",
    "weekday.mon": "Lun",
    "weekday.tue": "Mar",
    "weekday.wed": "Mer",
    "weekday.thu": "Gio",
    "weekday.fri": "Ven",
    "weekday.sat": "Sab",
    "weekday.sun": "Dom",
  },
  fr: {
    "lang.it": "Italien",
    "lang.fr": "Francais",
    "lang.en": "Anglais",
    "app.brandSub": "CookOps - Operations quotidiennes du restaurant",
    "app.selectSite": "Selectionner un site",
    "app.settings": "Parametres",
    "app.menuToggle": "Ouvrir ou fermer le menu",
    "app.sidebarTitle": "Menu operationnel",
    "app.sidebarToggle": "Reduire ou agrandir le menu lateral",
    "app.pageHead": "Site: {site} | API: {api}",
    "app.siteNotSelected": "non selectionne",
    "nav.dashboard": "Tableau de bord",
    "nav.dashboardHelp": "KPI et urgences",
    "nav.inventory": "Stock",
    "nav.inventoryHelp": "Stocks, lots, alertes",
    "nav.purchases": "Achats",
    "nav.purchasesHelp": "Bons, factures, ingestion",
    "nav.suppliers": "Fournisseurs et tarifs",
    "nav.suppliersHelp": "Fiche fournisseurs",
    "nav.recipes": "Recettes et cartes",
    "nav.recipesHelp": "Carte fixe et menu du jour",
    "nav.orders": "Commandes",
    "nav.ordersHelp": "Listes ingredients et commandes",
    "nav.reconciliations": "Rapprochements",
    "nav.reconciliationsHelp": "Bons et factures",
    "nav.reports": "Rapports",
    "nav.reportsHelp": "Ventes POS et ecarts",
    "notice.ready": "Pret.",
    "notice.errorWithDetail": "{label}: {detail}",
    "notice.spaceCreated": "Espace cree: {label}",
    "notice.sitesLoaded": "Sites charges: {count}",
    "notice.documentsLoaded": "Documents charges: {count}",
    "notice.suppliersUpdated": "Fournisseurs mis a jour: {count}",
    "notice.supplierCreated": "Fournisseur cree: {name}",
    "notice.siteCreated": "Site cree: {name}",
    "notice.siteReactivated": "Site reactive: {name}",
    "notice.siteDeleted": "Site supprime definitivement: {name}",
    "notice.siteDisabled": "Site desactive.",
    "notice.documentUploaded": "Document charge: {name}",
    "notice.extractionSaved": "Extraction enregistree: {id}",
    "notice.documentIngested": "Document enregistre: {id}",
    "notice.reconciliationCreated": "Rapprochement cree: {id}",
    "notice.salesImported": "Ventes importees: {id}",
    "notice.menuSaved": "Carte enregistree.",
    "notice.checklistUpdated": "Checklist ingredients mise a jour.",
    "notice.entryUpdated": "Element mis a jour.",
    "notice.entryAdded": "Element ajoute.",
    "action.close": "Fermer",
    "action.edit": "Modifier",
    "action.add": "Ajouter",
    "action.save": "Enregistrer",
    "action.print": "Imprimer",
    "action.pdf": "PDF",
    "action.generateChecklist": "Generer checklist",
    "action.loading": "Chargement...",
    "label.language": "Langue",
    "label.typeMenu": "Type de carte: {type}",
    "label.noSection": "Sans section",
    "label.noCategory": "Sans categorie",
    "label.noSupplier": "Sans fournisseur",
    "action.delete": "Supprimer",
    "action.down": "Bas",
    "action.remove": "Retirer",
    "action.replace": "Remplacer",
    "action.select": "Selectionner",
    "action.up": "Haut",
    "confirm.disableSite": "Desactiver ce site ? Vous pourrez le reactiver plus tard.",
    "dashboard.activeMenuItems": "Elements de carte actifs",
    "dashboard.activeSites": "Sites actifs",
    "dashboard.foodCost": "Food cost",
    "dashboard.foodCostDesc": "La comparaison theorique vs reel est disponible dans le module Rapports.",
    "dashboard.importedDocs": "Documents importes",
    "dashboard.recoStatus": "Etat des rapprochements",
    "dashboard.recoStatusDesc": "Utilisez la section Rapprochements pour associer bons et factures.",
    "dashboard.urgencies": "Urgences",
    "dashboard.urgency.docs": "Verifier les documents en attente d'ingestion",
    "dashboard.urgency.lots": "Verifier les lots avec DLC proche",
    "dashboard.urgency.pos": "Confirmer l'import POS quotidien",
    "deleteSite.confirmPrompt": "Pour confirmer, tapez :",
    "deleteSite.confirmText": "SUPPRIMER DEFINITIVEMENT",
    "deleteSite.deleteForever": "Supprimer definitivement",
    "deleteSite.descStart": "Cette action supprime definitivement",
    "deleteSite.title": "Supprimer le site",
    "error.apiConnectionSites": "Connexion API echouee sur /sites. Verifiez runserver, CORS et X-API-Key.",
    "error.checklistConnection": "Erreur de connexion pendant le chargement de la checklist.",
    "error.checklistForDay": "Checklist failed",
    "error.documentsLoad": "Documents load error",
    "error.documentUpload": "Upload failed",
    "error.extractionCreate": "Extraction failed",
    "error.fichesImportJson": "Fiches JSON import failed",
    "error.fichesImportJsonConnection": "Erreur de connexion pendant l'import JSON fiches.",
    "error.fichesSync": "Fiches sync failed",
    "error.fichesSyncConnection": "Erreur de connexion pendant la synchronisation des fiches.",
    "error.ingest": "Ingest failed",
    "error.menuLoad": "Menu load failed",
    "error.menuLoadBackend": "Erreur de chargement de la carte depuis le backend.",
    "error.menuReloadBeforeChecklist": "Impossible de recharger la carte depuis le backend avant la checklist.",
    "error.menuSync": "Menu sync failed",
    "error.posImport": "POS import failed",
    "error.printOpen": "Impossible d'ouvrir le document d'impression.",
    "error.reconciliationCreate": "Reconciliation failed",
    "error.siteCreate": "Site creation failed",
    "error.siteCreateConnection": "La creation du site a echoue a cause d'une erreur de connexion/API.",
    "error.siteDelete": "Delete failed",
    "error.siteDisable": "Disable failed",
    "error.siteReactivate": "Reactivation failed",
    "error.sitesLoad": "Sites error",
    "error.supplierCreate": "Supplier creation failed",
    "error.suppliersLoad": "Suppliers error",
    "inventory.alerts": "Alertes",
    "inventory.alertsDesc": "Bientot: sous-stock, DLC proches et lots bloques.",
    "inventory.item1": "Stocks par site et par secteur",
    "inventory.item2": "Dates d'expiration",
    "inventory.item3": "Corrections manuelles tracees",
    "inventory.stockLots": "Stocks et lots",
    "menuEditor.addEntry": "Ajouter une entree",
    "menuEditor.editSpace": "Modifier espace: {space}",
    "menuEditor.entryType": "Type d'entree",
    "menuEditor.entryTypeProduct": "Produit",
    "menuEditor.entryTypeRecipe": "Recette",
    "menuEditor.fichePortions": "Portions fiche",
    "menuEditor.linkedRecipe": "Recette liee",
    "menuEditor.notMapped": "non mappee (titre introuvable)",
    "menuEditor.saveReplacement": "Enregistrer le remplacement",
    "menuEditor.schedule": "Planification",
    "menuEditor.scheduleDateRange": "Date specifique/periode",
    "menuEditor.schedulePermanent": "Permanent (toujours actif)",
    "menuEditor.scheduleWeekly": "Recurrence hebdomadaire",
    "menuEditor.section": "Section",
    "menuEditor.targetPortions": "Portions cibles",
    "menuEditor.title": "Titre",
    "menuEditor.titlePlaceholder": "Rechercher recette/produit",
    "menuEditor.validFrom": "Valide du",
    "menuEditor.validTo": "Valide au",
    "menuEditor.weekdays": "Jours recurrents",
    "notice.fichesJsonImported": "Import JSON fiches termine. Lus: {read}, nouveaux snapshots: {created}, inchanges: {unchanged}.",
    "notice.fichesSynced": "Fiches synchronisees. Lus: {read}, nouveaux snapshots: {created}, inchanges: {unchanged}.",
    "notice.noActiveSites": "Aucun site actif trouve. Ouvrez Parametres pour en creer un.",
    "orders.categoriesSectors": "Categories/secteurs",
    "orders.dateFrom": "Date debut",
    "orders.dateTo": "Date fin",
    "orders.derivedFromInternalPrep": "Derive d'une preparation interne",
    "orders.desc": "Periode de dates, filtres carte/categories et sortie par fournisseur, recette ou secteur.",
    "orders.include": "Inclure",
    "orders.includedMenus": "Cartes incluses",
    "orders.ingredientsOnly": "Liste ingredients uniquement",
    "orders.internalPrep": "preparation interne",
    "orders.key": "Cle",
    "orders.menu": "Carte",
    "orders.noCategory": "Aucune categorie disponible.",
    "orders.noRecipeCard": "Aucun encart recette trouve pour cette recherche.",
    "orders.noResultsYet": "Aucun resultat pour le moment. Cliquez sur \"Generer checklist\".",
    "orders.noSectorCard": "Aucun encart secteur trouve pour cette recherche.",
    "orders.noSupplierCard": "Aucun encart fournisseur trouve pour cette recherche.",
    "orders.qtySuggested": "Quantites suggerees",
    "orders.recipeChecklist": "Checklist recette",
    "orders.searchRecipe": "Recherche recette",
    "orders.searchRecipePlaceholder": "Rechercher recette ou categorie",
    "orders.searchSector": "Recherche secteur",
    "orders.searchSectorPlaceholder": "Rechercher secteur, ingredient ou fournisseur",
    "orders.searchSupplier": "Recherche fournisseur",
    "orders.searchSupplierPlaceholder": "Rechercher fournisseur, ingredient ou code",
    "orders.sectorCategory": "Secteur/Categorie",
    "orders.sectorOrderCard": "Commande secteur",
    "orders.supplierOrderCard": "Commande fournisseur",
    "orders.title": "Listes de commande",
    "orders.viewRecipe": "3 - Checklist par recette",
    "orders.viewSector": "2 - Checklist par secteur",
    "orders.viewSupplier": "1 - Checklist par fournisseur",
    "purchases.confirmOcrData": "Confirmer les donnees OCR",
    "purchases.deliveryNote": "Bon de livraison",
    "purchases.deliveryNotesPlural": "Bons de livraison",
    "purchases.destination": "Destination",
    "purchases.document": "Document",
    "purchases.documentType": "Type de document",
    "purchases.extractionId": "ID extraction",
    "purchases.file": "Fichier",
    "purchases.invoice": "Facture",
    "purchases.invoicesPlural": "Factures",
    "purchases.readDataJson": "Donnees lues (JSON)",
    "purchases.refreshDocuments": "Actualiser documents",
    "purchases.registerDocument": "Enregistrer document",
    "purchases.step1Title": "1) Charger bon de livraison ou facture",
    "purchases.step2Title": "2) Verifier extraction OCR",
    "purchases.step3Title": "3) Enregistrer dans CookOps",
    "purchases.uploadDocument": "Charger document",
    "recipes.menuSpaces": "Espaces carte",
    "recipes.noActiveSpace": "Aucun espace actif. Activez-en un dans les Parametres avances.",
    "recipes.noItems": "Aucun element. Cliquez sur Modifier pour ajouter plats, cocktails ou produits.",
    "recipes.serviceDate": "Date de service",
    "recipes.targetPortions": "Portions cibles",
    "reco.goodsReceiptLine": "Ligne bon de livraison (UUID)",
    "reco.invoiceLine": "Ligne facture (UUID)",
    "reco.linkInvoiceAndNote": "Lier facture et bon",
    "reco.manualTitle": "Rapprochement manuel bons/factures",
    "reco.nextStep": "Etape suivante: matching assiste avec suggestions automatiques et feux de signalisation.",
    "reco.status": "Etat",
    "report.analysis": "Analyse",
    "report.analysisDesc": "Bientot: food cost theorique vs reel, ecarts et export CSV/PDF.",
    "report.dailyPosImport": "Import POS quotidien",
    "report.importSales": "Importer ventes",
    "report.posSourceId": "ID source POS",
    "report.posSourcePlaceholder": "UUID source POS",
    "report.salesDate": "Date des ventes",
    "report.salesLinesJson": "Lignes de ventes (JSON)",
    "settings.active": "actif",
    "settings.activeShort": "Actif",
    "settings.addSection": "Ajouter section",
    "settings.addSpace": "Ajouter espace",
    "settings.advancedMenuSpaces": "Mode avance des espaces carte",
    "settings.apiKey": "Cle API (X-API-Key)",
    "settings.availableSites": "Sites disponibles",
    "settings.code": "Code",
    "settings.createSite": "Creer site",
    "settings.disable": "Desactiver",
    "settings.disabled": "desactive",
    "settings.name": "Nom",
    "settings.newSection": "Nouvelle section",
    "settings.newSectionPlaceholder": "ex. Entrees",
    "settings.newSite": "Nouveau site",
    "settings.newSpace": "Nouvel espace",
    "settings.newSpacePlaceholder": "ex. Carte des vins",
    "settings.reactivate": "Reactiver",
    "settings.recipesPageSettings": "Parametres page Recettes et cartes",
    "settings.refreshSites": "Actualiser sites",
    "settings.scheduleDate": "Par date",
    "settings.schedulePermanent": "Permanent",
    "settings.scheduleRecurring": "Recurrence hebdo",
    "settings.sectionsForSpace": "Sections par espace",
    "settings.siteCodePlaceholder": "Optionnel (auto depuis le nom)",
    "settings.siteNamePlaceholder": "ex. Paillotte Beach",
    "settings.space": "Espace",
    "settings.spaces": "Espaces",
    "settings.spaceType": "Type d'espace",
    "settings.spaceTypeMixed": "Mixte",
    "settings.spaceTypeRecipes": "Recettes",
    "settings.spaceTypeSupplierProducts": "Produits fournisseur",
    "settings.title": "Parametres",
    "suppliers.addSupplier": "Ajouter fournisseur",
    "suppliers.fichesImport": "Importer JSON fiches v1.1",
    "suppliers.fichesImportDesc": "Fallback manuel: importer un export JSON v1.1 depuis fichier.",
    "suppliers.fichesImportLoading": "Import JSON fiches...",
    "suppliers.fichesSync": "Synchroniser fiches",
    "suppliers.fichesSyncDesc": "Synchronise automatiquement toutes les fiches dans CookOps (delta hash + historique).",
    "suppliers.fichesSyncLoading": "Synchronisation fiches...",
    "suppliers.list": "Liste fournisseurs",
    "suppliers.manage": "Gestion fournisseurs",
    "suppliers.namePlaceholder": "Nom fournisseur",
    "suppliers.newSupplier": "Nouveau fournisseur",
    "suppliers.refreshList": "Actualiser liste",
    "suppliers.vat": "TVA",
    "table.ingredient": "Ingredient",
    "table.qty": "Qte",
    "table.remaining": "Reste",
    "table.supplier": "Fournisseur",
    "table.supplierCode": "Code fournisseur",
    "table.toOrder": "A commander",
    "table.unit": "UM",
    "validation.dateRangeTooWide": "Periode trop large. Maximum 62 jours.",
    "validation.entryTitleRequired": "Saisissez au moins un titre.",
    "validation.invalidDateRange": "Periode de dates invalide.",
    "validation.invalidExtractionJson": "JSON extraction invalide.",
    "validation.invalidJsonFile": "Fichier JSON invalide.",
    "validation.invalidSalesJson": "JSON lignes ventes invalide.",
    "validation.keepAtLeastOneSpace": "Au moins un espace doit rester.",
    "validation.sectionExists": "Cette section existe deja.",
    "validation.selectJsonFileFirst": "Selectionnez d'abord un fichier JSON export v1.1.",
    "validation.selectSite": "Selectionnez un site.",
    "validation.selectSiteBeforeChecklist": "Selectionnez un site avant de generer la checklist.",
    "validation.selectValidDateRange": "Selectionnez une periode valide.",
    "validation.siteCodeInvalid": "Code site invalide.",
    "validation.siteNameRequired": "Saisissez le nom du site.",
    "validation.spaceExists": "Un espace avec ce nom existe deja.",
    "validation.spaceNameInvalid": "Nom d'espace invalide.",
    "validation.spaceNameRequired": "Saisissez le nom du nouvel espace.",
    "validation.targetPortionsGtZero": "Les portions cibles doivent etre superieures a 0.",
    "validation.weeklyNeedsDay": "Si recurrence hebdomadaire selectionnee, indiquez au moins un jour.",
    "weekday.fri": "Ven",
    "weekday.mon": "Lun",
    "weekday.sat": "Sam",
    "weekday.sun": "Dim",
    "weekday.thu": "Jeu",
    "weekday.tue": "Mar",
    "weekday.wed": "Mer",
  },
  en: {
    "lang.it": "Italian",
    "lang.fr": "French",
    "lang.en": "English",
    "app.brandSub": "CookOps - Daily restaurant operations",
    "app.selectSite": "Select site",
    "app.settings": "Settings",
    "app.menuToggle": "Open or close menu",
    "app.sidebarTitle": "Operations menu",
    "app.sidebarToggle": "Collapse or expand sidebar",
    "app.pageHead": "Site: {site} | API: {api}",
    "app.siteNotSelected": "not selected",
    "nav.dashboard": "Dashboard",
    "nav.dashboardHelp": "KPIs and urgencies",
    "nav.inventory": "Inventory",
    "nav.inventoryHelp": "Stocks, lots, alerts",
    "nav.purchases": "Purchases",
    "nav.purchasesHelp": "Delivery notes, invoices, ingest",
    "nav.suppliers": "Suppliers and prices",
    "nav.suppliersHelp": "Supplier master data",
    "nav.recipes": "Recipes and menus",
    "nav.recipesHelp": "Permanent and daily menus",
    "nav.orders": "Order checklists",
    "nav.ordersHelp": "Ingredients and orders",
    "nav.reconciliations": "Reconciliations",
    "nav.reconciliationsHelp": "Delivery notes and invoices",
    "nav.reports": "Reports",
    "nav.reportsHelp": "POS sales and variance",
    "notice.ready": "Ready.",
    "notice.errorWithDetail": "{label}: {detail}",
    "notice.spaceCreated": "Space created: {label}",
    "notice.sitesLoaded": "Sites loaded: {count}",
    "notice.documentsLoaded": "Documents loaded: {count}",
    "notice.suppliersUpdated": "Suppliers refreshed: {count}",
    "notice.supplierCreated": "Supplier created: {name}",
    "notice.siteCreated": "Site created: {name}",
    "notice.siteReactivated": "Site reactivated: {name}",
    "notice.siteDeleted": "Site permanently deleted: {name}",
    "notice.siteDisabled": "Site disabled.",
    "notice.documentUploaded": "Document uploaded: {name}",
    "notice.extractionSaved": "Extraction saved: {id}",
    "notice.documentIngested": "Document ingested: {id}",
    "notice.reconciliationCreated": "Reconciliation created: {id}",
    "notice.salesImported": "Sales imported: {id}",
    "notice.menuSaved": "Menu saved.",
    "notice.checklistUpdated": "Ingredient checklist refreshed.",
    "notice.fichesSynced": "Fiches synced. Read: {read}, new snapshots: {created}, unchanged: {unchanged}.",
    "notice.fichesJsonImported": "Fiches JSON import completed. Read: {read}, new snapshots: {created}, unchanged: {unchanged}.",
    "notice.entryUpdated": "Entry updated.",
    "notice.entryAdded": "Entry added.",
    "action.close": "Close",
    "action.edit": "Edit",
    "action.add": "Add",
    "action.save": "Save",
    "action.print": "Print",
    "action.pdf": "PDF",
    "action.generateChecklist": "Generate checklist",
    "action.loading": "Loading...",
    "label.language": "Language",
    "label.typeMenu": "Menu type: {type}",
    "label.noSection": "No section",
    "label.noCategory": "No category",
    "label.noSupplier": "No supplier",
    "action.delete": "Delete",
    "action.remove": "Remove",
    "action.replace": "Replace",
    "action.select": "Select",
    "action.up": "Up",
    "action.down": "Down",
    "confirm.disableSite": "Disable this site? You can reactivate it later.",
    "dashboard.activeSites": "Active sites",
    "dashboard.importedDocs": "Imported documents",
    "dashboard.activeMenuItems": "Active menu items",
    "dashboard.urgencies": "Urgencies",
    "dashboard.urgency.docs": "Check documents pending ingest",
    "dashboard.urgency.lots": "Review lots with close expiry",
    "dashboard.urgency.pos": "Confirm daily POS import",
    "dashboard.foodCost": "Food cost",
    "dashboard.foodCostDesc": "Theoretical vs actual comparison is available in Reports.",
    "dashboard.recoStatus": "Reconciliation status",
    "dashboard.recoStatusDesc": "Use Reconciliations to match delivery notes and invoices.",
    "recipes.menuSpaces": "Menu spaces",
    "recipes.serviceDate": "Service date",
    "recipes.targetPortions": "Target portions",
    "recipes.noItems": "No items yet. Press Edit to add dishes, cocktails, or products.",
    "recipes.noActiveSpace": "No active space. Enable one in advanced settings.",
    "orders.title": "Order checklists",
    "orders.desc": "Date range, menu/category filters, and output by supplier, recipe, or sector.",
    "orders.dateFrom": "Start date",
    "orders.dateTo": "End date",
    "orders.includedMenus": "Included menus",
    "orders.include": "Include",
    "orders.menu": "Menu",
    "orders.key": "Key",
    "orders.categoriesSectors": "Categories/sectors",
    "orders.sectorCategory": "Sector/Category",
    "orders.noCategory": "No category available.",
    "orders.viewSupplier": "1 - Checklist by supplier",
    "orders.viewSector": "2 - Checklist by sector",
    "orders.viewRecipe": "3 - Checklist by recipe",
    "orders.qtySuggested": "Suggested quantities",
    "orders.ingredientsOnly": "Ingredients only",
    "orders.searchSupplier": "Search supplier",
    "orders.searchSupplierPlaceholder": "Search supplier, ingredient, or code",
    "orders.searchSector": "Search sector",
    "orders.searchSectorPlaceholder": "Search sector, ingredient, or supplier",
    "orders.searchRecipe": "Search recipe",
    "orders.searchRecipePlaceholder": "Search recipe or category",
    "orders.noResultsYet": "No results yet. Press \"Generate checklist\".",
    "orders.noSupplierCard": "No supplier card found for this search.",
    "orders.noSectorCard": "No sector card found for this search.",
    "orders.noRecipeCard": "No recipe card found for this search.",
    "orders.derivedFromInternalPrep": "Derived from internal prep",
    "orders.internalPrep": "internal prep",
    "orders.supplierOrderCard": "Supplier order",
    "orders.sectorOrderCard": "Sector order",
    "orders.recipeChecklist": "Recipe checklist",
    "suppliers.manage": "Supplier management",
    "suppliers.newSupplier": "New supplier",
    "suppliers.namePlaceholder": "Supplier name",
    "suppliers.addSupplier": "Add supplier",
    "suppliers.refreshList": "Refresh list",
    "suppliers.fichesSyncDesc": "Automatically sync all fiches into CookOps (hash delta + history).",
    "suppliers.fichesSync": "Sync fiches",
    "suppliers.fichesSyncLoading": "Syncing fiches...",
    "suppliers.fichesImportDesc": "Manual fallback: import JSON v1.1 export from file.",
    "suppliers.fichesImport": "Import fiches JSON v1.1",
    "suppliers.fichesImportLoading": "Importing fiches JSON...",
    "suppliers.list": "Suppliers list",
    "suppliers.vat": "VAT",
    "purchases.step1Title": "1) Upload delivery note or invoice",
    "purchases.documentType": "Document type",
    "purchases.deliveryNote": "Delivery note",
    "purchases.invoice": "Invoice",
    "purchases.file": "File",
    "purchases.uploadDocument": "Upload document",
    "purchases.refreshDocuments": "Refresh documents",
    "purchases.step2Title": "2) Review OCR extraction",
    "purchases.document": "Document",
    "purchases.readDataJson": "Read data (JSON)",
    "purchases.confirmOcrData": "Confirm OCR data",
    "purchases.step3Title": "3) Register in CookOps",
    "purchases.extractionId": "Extraction ID",
    "purchases.destination": "Destination",
    "purchases.deliveryNotesPlural": "Delivery notes",
    "purchases.invoicesPlural": "Invoices",
    "purchases.registerDocument": "Register document",
    "reco.manualTitle": "Manual delivery note/invoice reconciliation",
    "reco.invoiceLine": "Invoice line (UUID)",
    "reco.goodsReceiptLine": "Delivery note line (UUID)",
    "reco.linkInvoiceAndNote": "Link invoice and note",
    "reco.status": "Status",
    "reco.nextStep": "Next step: assisted matching with automatic suggestions and traffic lights.",
    "inventory.stockLots": "Stocks and lots",
    "inventory.item1": "Stock by site and sector",
    "inventory.item2": "Expiry dates",
    "inventory.item3": "Tracked manual adjustments",
    "inventory.alerts": "Alerts",
    "inventory.alertsDesc": "Coming soon: low stock, near expiry, and blocked lots.",
    "report.dailyPosImport": "Daily POS import",
    "report.salesDate": "Sales date",
    "report.posSourceId": "POS source ID",
    "report.posSourcePlaceholder": "POS source UUID",
    "report.salesLinesJson": "Sales lines (JSON)",
    "report.importSales": "Import sales",
    "report.analysis": "Analysis",
    "report.analysisDesc": "Coming soon: theoretical vs actual food cost, variances, and CSV/PDF export.",
    "settings.title": "Settings",
    "settings.apiKey": "API key (X-API-Key)",
    "settings.refreshSites": "Refresh sites",
    "settings.newSite": "New site",
    "settings.name": "Name",
    "settings.code": "Code",
    "settings.siteNamePlaceholder": "e.g. Paillotte Beach",
    "settings.siteCodePlaceholder": "Optional (auto from name)",
    "settings.createSite": "Create site",
    "settings.availableSites": "Available sites",
    "settings.active": "active",
    "settings.disabled": "disabled",
    "settings.disable": "Disable",
    "settings.reactivate": "Reactivate",
    "settings.recipesPageSettings": "Recipes and menus page settings",
    "settings.advancedMenuSpaces": "Advanced menu spaces mode",
    "settings.spaces": "Spaces",
    "settings.spaceTypeRecipes": "Recipes",
    "settings.spaceTypeSupplierProducts": "Supplier products",
    "settings.spaceTypeMixed": "Mixed",
    "settings.schedulePermanent": "Permanent",
    "settings.scheduleDate": "Date based",
    "settings.scheduleRecurring": "Weekly recurring",
    "settings.activeShort": "Active",
    "settings.newSpace": "New space",
    "settings.newSpacePlaceholder": "e.g. Wine list",
    "settings.spaceType": "Space type",
    "settings.addSpace": "Add space",
    "settings.sectionsForSpace": "Sections per space",
    "settings.space": "Space",
    "settings.newSection": "New section",
    "settings.newSectionPlaceholder": "e.g. Starters",
    "settings.addSection": "Add section",
    "menuEditor.editSpace": "Edit space: {space}",
    "menuEditor.title": "Title",
    "menuEditor.titlePlaceholder": "Search recipe/product",
    "menuEditor.entryType": "Entry type",
    "menuEditor.entryTypeRecipe": "Recipe",
    "menuEditor.entryTypeProduct": "Product",
    "menuEditor.linkedRecipe": "Linked recipe",
    "menuEditor.notMapped": "not mapped (title not found)",
    "menuEditor.fichePortions": "Fiche portions",
    "menuEditor.targetPortions": "Target portions",
    "menuEditor.section": "Section",
    "menuEditor.schedule": "Scheduling",
    "menuEditor.schedulePermanent": "Permanent (always active)",
    "menuEditor.scheduleDateRange": "Specific date/range",
    "menuEditor.scheduleWeekly": "Weekly recurrence",
    "menuEditor.weekdays": "Recurring weekdays",
    "menuEditor.validFrom": "Valid from",
    "menuEditor.validTo": "Valid to",
    "menuEditor.saveReplacement": "Save replacement",
    "menuEditor.addEntry": "Add entry",
    "deleteSite.title": "Delete site",
    "deleteSite.descStart": "This action permanently deletes",
    "deleteSite.confirmPrompt": "To confirm, type:",
    "deleteSite.confirmText": "DELETE PERMANENTLY",
    "deleteSite.deleteForever": "Delete permanently",
    "table.ingredient": "Ingredient",
    "table.supplier": "Supplier",
    "table.supplierCode": "Supplier code",
    "table.qty": "Qty",
    "table.unit": "UoM",
    "table.remaining": "Remaining",
    "table.toOrder": "To order",
    "validation.spaceNameRequired": "Enter the new space name.",
    "validation.spaceNameInvalid": "Invalid space name.",
    "validation.spaceExists": "A space with this name already exists.",
    "validation.keepAtLeastOneSpace": "At least one space must remain.",
    "validation.sectionExists": "This section already exists.",
    "validation.siteNameRequired": "Enter the site name.",
    "validation.siteCodeInvalid": "Invalid site code.",
    "validation.selectJsonFileFirst": "Select a JSON export v1.1 file first.",
    "validation.invalidJsonFile": "Invalid JSON file.",
    "validation.invalidExtractionJson": "Invalid extraction JSON.",
    "validation.invalidSalesJson": "Invalid sales lines JSON.",
    "validation.entryTitleRequired": "Enter at least a title.",
    "validation.targetPortionsGtZero": "Target portions must be greater than 0.",
    "validation.weeklyNeedsDay": "If weekly recurrence is selected, choose at least one day.",
    "validation.selectSiteBeforeChecklist": "Select a site before generating checklist.",
    "validation.selectSite": "Select a site.",
    "validation.selectValidDateRange": "Select a valid date range.",
    "validation.invalidDateRange": "Invalid date range.",
    "validation.dateRangeTooWide": "Date range too wide. Use max 62 days.",
    "notice.noActiveSites": "No active site found. Open Settings to create one.",
    "error.menuLoad": "Menu load failed",
    "error.menuLoadBackend": "Error loading menu from backend.",
    "error.sitesLoad": "Sites error",
    "error.apiConnectionSites": "API connection failed on /sites. Check runserver, CORS and X-API-Key.",
    "error.siteCreate": "Site creation failed",
    "error.siteCreateConnection": "Site creation failed due to connection/API error.",
    "error.siteDisable": "Disable failed",
    "error.siteDelete": "Delete failed",
    "error.siteReactivate": "Reactivation failed",
    "error.suppliersLoad": "Suppliers error",
    "error.supplierCreate": "Supplier creation failed",
    "error.fichesSync": "Fiches sync failed",
    "error.fichesSyncConnection": "Connection error during fiches sync.",
    "error.fichesImportJson": "Fiches JSON import failed",
    "error.fichesImportJsonConnection": "Connection error during fiches JSON import.",
    "error.documentsLoad": "Documents load error",
    "error.documentUpload": "Upload failed",
    "error.extractionCreate": "Extraction failed",
    "error.ingest": "Ingest failed",
    "error.reconciliationCreate": "Reconciliation failed",
    "error.posImport": "POS import failed",
    "error.menuSync": "Menu sync failed",
    "error.checklistForDay": "Checklist failed",
    "error.checklistConnection": "Connection error during checklist load.",
    "error.menuReloadBeforeChecklist": "Cannot reload menu from backend before checklist.",
    "error.printOpen": "Cannot open print document.",
    "weekday.mon": "Mon",
    "weekday.tue": "Tue",
    "weekday.wed": "Wed",
    "weekday.thu": "Thu",
    "weekday.fri": "Fri",
    "weekday.sat": "Sat",
    "weekday.sun": "Sun",
  },
};

export function getInitialLang(): Lang {
  const stored = localStorage.getItem(LANG_STORAGE_KEY);
  if (stored === "it" || stored === "fr" || stored === "en") {
    return stored;
  }
  const browser = navigator.language.toLowerCase();
  if (browser.startsWith("fr")) return "fr";
  if (browser.startsWith("en")) return "en";
  return "it";
}

export function t(lang: Lang, key: string, vars?: TranslationVars): string {
  const template = messages[lang]?.[key] ?? messages.en[key] ?? messages.it[key] ?? key;
  if (!vars) return template;
  return template.replace(/\{(\w+)\}/g, (_, name) => String(vars[name] ?? ""));
}
